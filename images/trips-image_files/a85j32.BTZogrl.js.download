(this.$WP=this.$WP||[]).push(["a85j32",(e,t)=>{var i,a,r,n,l,o,d,s,c,p,u,m,v,h,g,_,f,b,y,I,T,w,k,C,N,P,S,D,x,M,B,A,E,L,R,O,j,z,V,G,q,F,H,W,U,Z,Y,X,$,J,K,Q,ee,et,ei,ea,er,en,el,eo,ed,es,ec,ep,eu,em,ev,eh,eg,e_,ef,eb,ey,eI,eT,ew,ek,eC,eN,eP,eS,eD,ex,eM,eB,eA,eE,eL,eR,eO,ej,ez,eV,eG,eq,eF,eH,eW,eU,eZ,eY,eX,e$,eJ,eK,eQ,e0,e1,e2,e3,e4,e6,e8,e9,e5,e7,te,tt,ti,ta,tr,tn,tl,to,td,ts,tc,tp,tu,tm,tv,th,tg,t_,tf,tb,ty,tI,tT,tw,tk,tC,tN,tP,tS,tD,tx,tM,tB,tA,tE,tL,tR,tO,tj,tz,tV=({children:e})=>{var[t,a]=n(!1),r=l(()=>({isStickyHeaderOpen:t,setIsStickyHeaderOpen:a}),[t,a]);return i(tr.Provider,{value:r,children:e})},tG=()=>{var e=o(tr);if(null==e)throw Error("useStickyHeaderContext used when not inside of a StickHeaderContextProvider");return e},tq=({children:e,scrollContainerRef:t,sectionRefMapping:a})=>{var[r,o]=n(0),d=s(a),u=s(new Map);c(()=>{d.current=a},[a]);var m=p((e,t)=>{var i="string"==typeof e?d.current.get(e):e;if(null==i||null==t)return()=>{};var a=u.current.get(i)||[];return a.push(t),u.current.set(i,a),function(){u.current.set(i,a.filter(e=>e!==t))}},[]),v=p(e=>{var i="string"==typeof e?d.current.get(e):e;if(i?.current){var a=u.current.get(i);a?.length?a.forEach(e=>e(n,i,r)):n(r)}function n(e){if(i?.current){var{y:a}=i.current.getBoundingClientRect();t?.current?.scrollBy({top:a-e,behavior:"smooth"})}}},[r,t]),h=l(()=>({sectionRefMapping:a,scrollOffset:r,setScrollOffset:o,scrollToSection:v,registerHandler:m,scrollContainerRef:t}),[a,r,o,v,m,t]);return i(tl.Provider,{value:h,children:i(tn,{children:e})})},tF=()=>{var e=o(tl);if(null==e)throw Error("useSectionScrollContext used when not inside of a SectionScrollProvider");return e},tH=(e,t)=>{var{registerHandler:i}=tF(),a=s(void 0);c(()=>{a.current=t});var r=p((e,t,i)=>{a.current?.(e,t,i)},[]);c(()=>i(e,r),[i,r,e])};function tW({onScroll:e,throttle:t,useDebounce:i,useCapture:a,scrollContainerRef:r}){var n=t||200,o=l(()=>O(e,n,{trailing:!i}),[e,n,i]);return c(()=>{var e=r?.current;if(null!=e&&null!=o)return e.addEventListener("scroll",o,a),()=>{e.removeEventListener("scroll",o,a)}},[r,o,a]),null}var tU={sticky:"aGWPa _U l",stickyHeader:"SRyWz t",visible:"APidY",row:"nhHCc f u k",tabWrapper:"_u w",saveOrViewTripCtaWrapper:"jZhZO I"},tZ=({anchorRef:e,tabBar:t,tabSectionRefs:r,onVisible:l,onActiveTabChange:o,saveOrViewTripCta:d})=>{var u=S(),m=E(),[v,h]=n(0),[g,_]=n(!1),[f,b]=n(0),y=s(null),{scrollToSection:T,setScrollOffset:w,scrollContainerRef:k}=tF(),{setIsStickyHeaderOpen:C}=tG(),N=p(()=>{if(e.current){var{offsetTop:t}=e.current,{top:i}=e.current.getBoundingClientRect(),a=i<t;_(a),C(a)}},[e,C]),P=p(()=>{var e=y.current?.getBoundingClientRect()?.top??0,t=(y.current?y.current.offsetHeight+10:10)+e;b(t),w(t)},[y,w,b]),D=p(()=>{var e=f+1,t=Number.MAX_SAFE_INTEGER,i=0;r.forEach((a,r)=>{if(a.current){var n=Math.abs(a.current.getBoundingClientRect().y-e);n<t&&(i=r,t=n)}}),i!==v&&o(i),h(i)},[r,f,v,o]),x=p(()=>{N(),P(),D()},[D,P,N]);return(c(()=>{N(),P()},[P,N]),c(()=>{g&&l?.()},[g,l]),m)?null:i("div",{ref:y,className:L(tU.sticky,tU.stickyHeader,g&&tU.visible),children:a(I,{fullBleedDesktopAndSmaller:!0,children:[i(R,{callback:x,throttle:300}),i(tW,{scrollContainerRef:k,onScroll:x,throttle:300}),a("div",{className:tU.row,children:[i("div",{className:tU.tabWrapper,children:t(T,v)}),i("div",{className:tU.saveOrViewTripCtaWrapper,children:"MOBILE"!==u&&d("sticky-header")})]})]})})},tY={"title-02":28,"title-03":24,"title-04":18,"body-01":16},tX=({width:e,variant:t="body-01"})=>i("div",{style:{width:e,height:tY[t]},className:eO("NvuUX o",{BfjIN:"title-02"===t,zhRLt:"title-03"===t,loyuq:"title-04"===t,gfvTs:"body-01"===t}),children:i(q,{})}),t$=["95%","97%","92%","98%","96%"],tJ=({lines:e=5,...t})=>{var[a]=ej(t);return i("div",{className:ez(a),children:[...Array(e).keys()].map(e=>i("div",{className:"tyqkd",children:i(ts,{width:t$[e%t$.length]})},e))})},tK=()=>i("div",{className:"w _Z Re o",children:i(q,{})}),tQ=()=>a("div",{children:[i(q,{}),i("div",{className:"_Q t l w",children:i(F,{})})]}),t0=({variant:e="ThumbsUp",tripId:t})=>{var a=T(),{localize:r}=f();return i("div",{ref:eP(p(()=>{a("TripDetailsFeedbackSucessfulSubmit",{tripId:t.toString()})},[a,t])),children:i(Z,{icon:"ThumbsUp"===e?eS:eD,children:i(U,{variant:"body-01",color:"onDarkText",children:"ThumbsUp"===e?r.string("gai_review_summary_feedback_thanks"):r.string("trips_feedback_thanks_thumbs_down")})})})},t1=({onSubmit:e})=>{var t=S(),{localize:l}=f(),o="MOBILE"===t,[d,s]=n(""),[c,u]=n(tm),[m,v]=n(!1),[h,g]=n(""),_=p((e,t)=>{v(t)},[]),b=p((e,t)=>{u(i=>i.map(i=>i.value===e?{...i,isChecked:t}:i))},[]),y=p(e=>{s(e.target.value)},[]),I=()=>{var t=d.trim();m&&!t?g(l.string("trips_gai_feedback_specify_issue")):(g(""),e([...c,{value:t,label:"Other",isChecked:!!t}]))};return a(r,{children:[a("section",{className:"Ma Nn MJ NP",children:[i(U,{variant:"body-01",children:l.string("trips_gai_feedback_sorry_to_hear_that")}),i(U,{variant:"title-03",marginTop:"spacing-02",children:l.string("trips_gai_feedback_wrong_recommendation")}),c.map(e=>i(eA,{checked:!!e.isChecked,value:e.value,label:e.label,onToggle:b},e.value)),i(eA,{checked:m,value:"4",label:l.string("trips_gai_feedback_other"),onToggle:_}),i(eB,{maxLength:160,errorText:h,value:d,marginTop:"spacing-03",placeholder:l.string("trips_gai_feedback_add_comments"),onChange:y})]}),a("section",{className:"VMdEM f k Pk P- Px PM _Q s w z Gi",children:[i(x,{onClick:I,children:l.string("trips_general_skip")}),i(D,{variant:"primary",size:"medium",onClick:I,fullWidth:o,marginBottom:o?"spacing-03":void 0,children:l.string("trips_general_submit")})]})]})},t2={headerContainer:"YhlKk f Pj PX Pw PJ B1 Z BB",imageContainer:"Xxueo o",descriptionContainer:"f e k Mi Nb MH NM"},t3=({item:e})=>a("div",{className:t2.headerContainer,children:[e.thumbnail?.photoSizes&&i("div",{className:t2.imageContainer,children:i(ea,{source:e.thumbnail?.photoSizes,aspectRatio:"1:1"})}),a("div",{className:t2.descriptionContainer,children:[a("div",{children:[e.name&&i(U,{lineClamp:2,variant:"supporting-03",marginBottom:"spacing-02",children:e.name}),e.reviewSummary?.rating&&e.reviewSummary?.count&&i(eE,{size:"small",rating:e.reviewSummary?.rating,numReviews:e.reviewSummary?.count})]}),e?.placeType&&i(eo,{item:e,variant:"minimal"})]})]}),t4=({item:e,isOpen:t,onSubmit:r})=>{var{open:n,close:l}=ex(()=>i(eM,{hideCloseButton:!0,overrideContentStyling:!0,children:i("div",{className:"JUjxe f e",children:a("div",{className:"yLpyj",children:[i("section",{className:"Ma Nn MK NP",children:i(t3,{item:e})}),i(t1,{onSubmit:r})]})})}));return c(()=>{t?n():l()},[t,n,l]),null},t6=({isThumbsUp:e,isThumbsDown:t,onThumbsUp:r,onThumbsDown:n,feedbackSent:l,...o})=>{var{localize:d}=f();return a("div",{className:eO("w f k v u Pi PN Pv PA",ez(o)),"data-automation":"trips_gai_preview_trip_day_item_feedback",children:[i(U,{variant:"supporting-01",children:i(_,{id:"trips_gai_feedback_useful_recommendation"})}),a("section",{className:"f v u",children:[i(M,{variant:"clear","aria-label":d.string("trips_gai_feedback_thumbs_up"),onClick:r,icon:e?eS:eL,disabled:l&&!e,dataAttributes:{"data-automation":"trips_gai_preview_trip_day_item_feedback_thumbs_up"}}),i(M,{variant:"clear","aria-label":d.string("trips_gai_feedback_thumbs_down"),onClick:n,icon:t?eD:eR,marginLeft:"spacing-03",disabled:l&&!t,dataAttributes:{"data-automation":"trips_gai_preview_trip_day_item_feedback_thumbs_down"}})]})]})},t8=e=>e.reduce((e,t)=>t.isChecked?tv.includes(t.value)||"string"!=typeof t.label?{...e,[t.value]:"selected"}:{...e,[t.label]:t.value}:e,{}),t9=({item:e,tripId:t,onSaveFeedback:l,...o})=>{var d=w(),[s,c]=n(!1),[u,m]=n(!1),[v,h]=n(!1),[g,_]=n(!1),[f]=eN(),b=p((i,a,r)=>{var n=r?t8(r):void 0;l?.(e.locationId?.toString()||"",a,n),d(i,{itemId:e.locationId?.toString()||"",tripId:t.toString(),...a?{helpful:a}:{},...n})},[d,t,l,e]),y=p(()=>{s||(m(!0),c(!0),b("TripDetailsFeedbackForm","YES"),f(i(t0,{tripId:t})))},[s,f,b,t]),I=p(()=>{s||(h(!0),_(!0),c(!0),b("TripDetailsFeedbackForm","NO"))},[s,b]),T=p(e=>{_(!1),b("TripDetailsExperienceIssues","NO",e),f(i(t0,{variant:"ThumbsDown",tripId:t}))},[f,b,t]);return a(r,{children:[i(t6,{isThumbsUp:u,isThumbsDown:v,onThumbsUp:y,onThumbsDown:I,feedbackSent:s,...o}),i(t4,{item:e,onSubmit:T,isOpen:g})]})},t5=({...e})=>i(eC,{children:i(t9,{...e})}),t7=({name:e,link:t,pricingInfo:r,tripId:n,itemId:l,bookableExperienceId:o})=>{var d=b(),s=w(),c=p(()=>{s("TripDetailsCTAClick",{tripId:n,itemId:l,bookableExperienceId:o})},[s,n,l,o]);if(!r?.fromPrice||!e)return null;var u=i(ew,{price:i(U,{variant:"supporting-03",display:"inline",children:d.formatCurrency(r.fromPrice)}),isPerGroupPricing:"UNIT"===r.pricingType,isTieredPricing:r.isTieredPricing||void 0,maxTravelersPerUnit:r.maxTravelersPerUnit||void 0}),m=a("div",{className:"QrFps f Pj PX Pw PJ Re B1 Z BC",children:[i("div",{className:"FiPRP f Pj PX Pw PJ Re",children:i(eI,{size:20})}),a("div",{className:"sIwXa f e w",children:[i(U,{variant:"supporting-01",lineClamp:1,children:e}),i("div",{className:"Nuwfk",children:i(U,{variant:"supporting-01",lineClamp:1,children:u})})]}),i("div",{className:"rkggC",children:i(eT,{size:24})})]});return t?i(er,{theme:"standalone",href:t,target:"_blank",onClick:c,children:m}):m},ie=({link:e,tripId:t,itemId:r,bookableExperienceId:n,pricingInfo:l})=>{var o=b(),d=w(),{localize:s}=f(),c=p(()=>{d("TripDetailsSeeOptions",{tripId:t,itemId:r,bookableExperienceId:n})},[d,t,r,n]);if(!l?.fromPrice)return null;var u=i(ew,{price:i(U,{variant:"supporting-03",display:"inline-block",children:o.formatCurrency(l.fromPrice)}),isPerGroupPricing:"UNIT"===l.pricingType});return a("div",{className:"YCbUQ f Mj",children:[i(U,{variant:"supporting-01",children:u}),e&&i(D,{variant:"secondary-commerce",size:"small",href:e,target:"_blank",onClick:c,children:s.string("trips_commerce_see_options")})]})},it=({item:e,tripId:t})=>{if(e?.object?.recommendedProduct){var a=e.object.recommendedProduct;return i(t7,{name:a.title?.text||null,pricingInfo:a.pricingInfo,link:a.route?.url,bookableExperienceId:e.object.recommendedProduct.activityId,tripId:t,itemId:e.id})}var r=e?.object?.object;if(J(r)){var n=r.object;if(n?.placeType==="ACTIVITY"&&n?.locationV2?.details?.__typename==="LocationSelection_AttractionProductDetails"&&n?.locationV2.details.productDetails?.pricingInfo)return i(ie,{tripId:t,itemId:e?.id,bookableExperienceId:r.locationId,name:n.name,pricingInfo:n.locationV2.details.productDetails.pricingInfo,link:n.route?.url})}return null},ii=({cardLink:e,tripId:t,title:r,description:l,award:o,photos:d,reviewSummary:s,tripItem:c,onSaveFeedbackItem:p,onClick:u,onIndividualSaveComplete:m})=>{var v=ef(),h="MOBILE"===S(),g=J(c.object?.object)&&c.object?.object?.object||null,{localize:_}=f(),[b,y]=n(0),I=(e,i)=>{v({itemName:"SuccessfulItemSave",itemType:"ViewGAI",customData:{itemId:c.id,gaiTripId:t,destinationTripId:i,saveCreationMethod:"GAI",isNew:"CREATED"===e}})},T=ed({reviewSummary:s}),w=o?.year?i(en,{size:"large",color:"BOTB"===o.awardType?"yellow":"green",year:o.year}):void 0,k=em(c.object?.object),C=i(eu,{id:k?.id??0,type:k?.type,onSaveComplete:m,viewTripOpensNewTab:!0,onViewTripToastVisible:I,onAutosavedToTripToastVisible:I,sourceTripId:t,tripItemId:c.id??0}),N=d?i(Q,{award:w,action:C,children:i(er,{theme:"image",href:e,target:"_blank",onClick:u,"data-automation":"trips_gai_preview_trip_day_item_image",children:i(el,{itemRenderer:e=>i(ea,{source:d?.[e],width:"100%",height:"100%"}),totalCount:d.length,currentIndex:b,onNav:e=>y(e),arrowSize:"small"})})}):void 0;return a(ee,{header:i(es,{onClick:u,title:r,reviewData:T,itemLink:e,content:g?.placeType&&i(eo,{item:g,variant:"extended"})}),media:N,secondary:i(tg,{tripId:t,item:c}),variant:"vertical",mediaLayout:{type:"FlexMediaVerticalHeight",height:h?150:200},children:[i(et,{children:i(eh,{ctaNewline:!0,numLinesToShow:h?5:3,webkitLineClamp:!0,collapsible:!0,cta:i(x,{variant:"primary-small",dataAttributes:{"data-automation":"trip_item_description_read_more_button"},children:a(ek,{display:"flex",alignItems:"center",children:[_.string("common_Read_more")," ",i(eg,{size:16})]})}),ctaCollapse:a(x,{variant:"primary-small",dataAttributes:{"data-automation":"trip_item_description_read_less_button"},children:[_.string("common_Readless")," ",i(e_,{size:16})]}),children:i(ei,{children:l})})}),g&&i(th,{item:g,tripId:t,onSaveFeedback:p})]})},ia={__key:0xd08cf1b9c92e,id:"d08cf1b9c92eb825",loc:{},definitions:[]},ir=e=>{if(!e)return null;var{locationItem:t}=e;return t?.object?.placeType==="ACTIVITY"&&t?.object?.locationV2?.details?.__typename==="LocationSelection_AttractionProductDetails"&&t?.object?.locationV2.details.productDetails?.pricingInfo?t?.locationId:e?.tripItem?.object?.recommendedProduct?e?.tripItem?.object?.recommendedProduct?.activityId:null},il=(e,t)=>{var i=96/(e.length||1);return Math.min(100,Math.round(e.reduce((e,t)=>0===t.items.length?e+(t.description?1:0):e+i*((t.items.filter(e=>null!=e.gaiNarration).length+(t.description?1:0))/(t.items.length+1)),0)+(t?4:0)))},io=e=>{var t=e?.object?.object;if(!J(t))return null;var i=t?.object;return t&&i?.locationId&&e.id?{id:e.id,latitude:i.latitude,longitude:i.longitude,placeType:i.placeType,name:i.name||null,gaiNarration:e?.object?.narrativeDescription?.plainText||null,reviewSummary:i.reviewSummary,photos:ev(i),url:i.route?.url||null,award:i.locationV2?.bestAwardForActiveYearV2?.year?{year:i.locationV2?.bestAwardForActiveYearV2.year,awardType:i.locationV2?.bestAwardForActiveYearV2.awardType??void 0}:void 0,tripItem:e,locationItem:t}:null},id=e=>{var t=e.generatedTripRequest?.locationIds?.[0],i=t?e.tripLocations?.find(e=>e?.location?.locationId===t):null;return i?i?.location:e.tripLocations?.[0]?.location},is=(e,t)=>{var{title:i,description:a,items:r,structure:n,generatedTripRequest:l}=e,{locationId:o,latitude:d,longitude:s,name:c}=id(e)??{},p=new Map;r?.forEach(e=>{e?.id&&p.set(e.id,e)});var u=n?.buckets?.filter(Boolean).map((e,i)=>{var a=t.string("triplist_itineraryday_ffffe73c",{0:i+1}),r=e.narrativeDescription?.plainText,n=e.narrativeDescription,l=[];return(e.items?.filter(Boolean).map(e=>p.get(e)).filter(Boolean)??[]).forEach(e=>{var t=io(e);t&&l.push(t)}),{id:e.id,title:a,description:r,formattedDescription:n,items:l}})??[];return{title:i,description:a,days:u,centerPoint:null!=d&&null!=s?{latitude:d,longitude:s}:null,geoId:o??null,geoName:c??"",includeChildren:l?.includeChildren??!1,travelingWith:l?.travelingWith,tripDate:l?.tripDate,progress:il(u,null!=a)}},ic=(e,t,i)=>{var a=y(),{localize:r}=f(),[l,o]=n(!0),d=s(null),p=s(null),[{fetching:u,error:m,data:v},h]=eV({query:ia,variables:{tripIds:[e??0],currency:a},pause:!e}),g=v?.Trips_getTrips?.[0]??null;return c(()=>{!u&&t&&d.current!==t&&(d.current&&(o(!0),p.current=g,h({requestPolicy:"network-only"})),d.current=t)},[h,u,g,t]),c(()=>{l&&"LOADING"!==i&&p.current!==g&&o(!1)},[l,i,g]),{fetching:u||l,error:m,trip:g?is(g,r):null}},ip="placesToStay",iu=e=>`tab:${e}`,im=(e,t)=>`item:${e}-${t}`,iv={container:"ryxip",sidebar:"JXcQL",bar:"fCjSP",card:"ImYPs",marker:"ZrEaT Gy j Pb PO Po PB",titleMarker:"tGROH",heading:"OrppK",headingIcon:"BCCEH I _T",collapsibleItem:"Lxgdh"},ih=({tripId:e,dayId:t,item:r,step:l,locationId:o,initiallyExpanded:d=!1,isConnected:s=!0,loading:c,onSaveFeedbackItem:u,onIndividualSaveComplete:m})=>{var[v,h]=n(d),{sectionRefMapping:g,scrollOffset:_,scrollContainerRef:f}=tF(),b=w(),y=g.get(im(t,r.id)),I="MOBILE"===S(),{setSelectedItemId:T}=N(),k=p(()=>{I||T(r.id)},[T,r.id,I]),C=p(()=>{T(null)},[T]);tH(y,(e,t)=>{var i=t?.current?.offsetTop??0;h(!0),setTimeout(()=>{f?.current?.scrollTo({top:i-_,behavior:"smooth"})},0)});var P=p(()=>{b("TripDetailsItemClick",{tripId:e,itemId:r.id,location:r.locationItem?.object?.name,bookableExperienceId:ir(r)})},[r,b,e]),D=p(i=>{b(i?"TripDetailsCollapse":"TripDetailsExpand",{tripId:e,dayId:t,locationId:o}),h(e=>!e)},[b,e,t,o]);if(c&&null==r.gaiNarration)return i(tI,{step:l,isExpanded:v});var x=J(r.tripItem.object?.object)&&r.tripItem.object?.object?.object||null,M=x?.placeType?eG(x):null,B=i(t_,{onClick:P,tripId:e,title:r.name,cardLink:r.url||void 0,photos:r.photos,award:r.award,reviewSummary:r.reviewSummary,onSaveFeedbackItem:u,description:r.gaiNarration&&i(U,{variant:"body-01",dataAttributes:{"data-automation":"trips_gai_preview_trip_day_item_narration","data-automation-day-id":t},children:r.gaiNarration}),tripItem:r.tripItem,onIndividualSaveComplete:m});return i(tb,{ref:y,step:l,title:a("div",{className:iv.heading,children:[M&&i("div",{className:iv.headingIcon,children:i(M,{size:16})}),r.name]}),content:B,isOpen:v,isConnected:s,onExpandCollapseClick:D,onMouseEnter:k,onMouseLeave:C,dataAttributes:{card:{"data-automation":"trips_gai_preview_day_item","data-automation-day-item-id":r.id}}})},ig=({step:e=1,isExpanded:t=!1,isConnected:a=!1})=>{var r="MOBILE"===S();return i(tb,{step:e,title:i(ts,{variant:"title-04",width:250}),content:i(ee,{header:i(ts,{variant:"title-04",width:200}),media:i(tp,{}),variant:"vertical",mediaLayout:{type:"FlexMediaVerticalHeight",height:r?150:200},children:i(et,{children:i(ei,{children:i(tc,{})})})}),isOpen:t,isConnected:a})},i_={openMapButton:"f u j w _Z",openMapOverlay:"VlNqW w _Z",closeMapButton:"BprOh",modal:"emGhX s _U Za Gg"},ib=({tripId:e,days:t,centerPoint:o,geoId:d,loading:s,hideMarkers:u})=>{var m="MOBILE"===S(),[h,g]=n(null),_=w(),{localize:b}=f(),{setSelectedItemId:y}=N(),{placesToStay:I,showPlacesToStay:T}=B();c(()=>{null!==h&&y(null)},[h,y]);var k=l(()=>[...u?[]:t.flatMap(e=>e.items).filter(e=>!s||null!=e.gaiNarration).map(({id:e,latitude:t,longitude:i,placeType:a,reviewSummary:r,name:n,photos:l,url:o,locationItem:d})=>e&&n&&t&&i&&a?{itemId:e,name:n,latitude:t,longitude:i,placeType:a,reviewSummary:r,thumbnail:l?.[0],url:o,locationItem:d}:null).filter(Boolean),...!u&&I&&T?I.map(e=>{var{locationId:t,latitude:i,longitude:a,placeType:r,reviewSummary:n,name:l,photos:o,route:d}=e;return t&&l&&i&&a&&r?{itemId:t,name:l,latitude:i,longitude:a,placeType:r,reviewSummary:n,thumbnail:o?.[0]?.photoSizes??[],url:d?.url,locationItem:{locationId:t,object:e}}:null}).filter(Boolean):[]],[t,u,s,I,T]),P=p(t=>{_(t.zoom>t.oldZoom?"TripDetailsZoomIn":"TripDetailsZoomOut",{tripId:e})},[_,e]),x=p(()=>{_("TripDetailsMapScroll",{tripId:e})},[_,e]),A=p(t=>{_("TripDetailsMapPinClick",{tripId:e,itemId:t})},[_,e]);return d&&o?h?i(z,{hideBackdrop:!0,className:i_.modal,children:i(j,{children:i(v,{children:i(C,{locations:k,latitude:o.latitude,longitude:o.longitude,geoId:d,loading:s,onZoomChange:P,onPanStart:x,onPinClick:A,cardPositioning:"map-bottom",children:i("div",{className:i_.closeMapButton,children:i(M,{icon:V,onClick:()=>g(!1),"aria-label":b.string("phoenix_accessibility_back_label")})})})})})}):i(C,{locations:k,latitude:o.latitude,longitude:o.longitude,geoId:d,loading:s,onZoomChange:P,onPanStart:x,onPinClick:A,hideLoadingIndicator:!0,children:m&&a(r,{children:[i("div",{className:i_.openMapOverlay}),i("div",{className:i_.openMapButton,children:a(D,{variant:"secondary",onClick:()=>g(!0),children:[i(G,{size:20}),b.string("trips_gai_trip_preview_map_view")]})})]})}):s?i(tu,{}):null},iy=({formattedText:e,referenceHighlighter:t,fallbackText:a})=>{if(!e?.text)return a;var r=new Map(e.references?.filter(Boolean).filter(e=>e?.name!=null).map(e=>[`{{${e.name}}}`,e]));return(e.text.match(RegExp("\\{\\{(?<tag>[\\w-]+)\\}\\}","gu"))||[]).every(e=>r.has(e))?e.text.split(RegExp("(?<tag>\\{\\{[\\w-]+\\}\\})","u")).map((e,a)=>{var n=r.get(e);return i(h,{children:n?t(n):e},a)}):a},iI={container:"XBzgG Y",content:"wltje _ Y",visible:"qKrBp"},iT=({children:e,placeholder:t,ready:r})=>{var[l,o]=n(!1);return c(()=>{var e=setTimeout(()=>{o(!0)},50);return()=>clearTimeout(e)},[]),a("div",{className:L(iI.container,l&&iI.visible),children:[i("div",{className:L(iI.content,r&&iI.visible),children:r?e:null}),!r&&t]})},iw={highlight:"Wb _S",emptyMessage:"c"},ik=({tripId:e,id:t,title:n,geoId:l,geoName:o,formattedDescription:d,fallbackDescription:s,items:c,expandFirstItem:p=!1,loading:u,onSaveFeedbackItem:m,onIndividualSaveComplete:v})=>{var{sectionRefMapping:h,scrollToSection:g}=tF(),f=w(),b=h.get(iu(t)),y=d||s?i(tw,{formattedText:d,fallbackText:s,referenceHighlighter:({value:a,itemId:r})=>{var n=r?h.get(im(t,r)):null;if(!n)return a;var l=()=>{f("TripDetailsTextJump",{tripId:e,itemId:r,text:a}),g(n)};return i("span",{role:"button",onClick:l,onKeyDown:e=>"Enter"===e.key&&l(),tabIndex:0,className:iw.highlight,children:i(U,{variant:"button-01",elementType:"span",children:a})})}}):null;return i("div",{ref:b,children:a(tk,{ready:!u||null!=y&&c.length>0,placeholder:a(r,{children:[i(U,{variant:"title-03",children:n}),i(tc,{marginTop:"spacing-02",marginBottom:"spacing-03"}),i(tI,{step:1,isConnected:!0,isExpanded:p}),i(tI,{step:2,isConnected:!0}),i(tI,{step:3})]}),children:[i(U,{variant:"title-03",dataAttributes:{"data-automation":"trips_gai_preview_trip_day_title","data-automation-day-id":t},children:n}),c.length>0?a(r,{children:[y&&i(U,{variant:"body-01",marginTop:"spacing-02",marginBottom:"spacing-03",dataAttributes:{"data-automation":"trips_gai_preview_trip_day_description","data-automation-day-id":t},children:y}),c.map((a,r)=>i(ty,{tripId:e,dayId:t,item:a,locationId:l,initiallyExpanded:p&&0===r,step:r+1,isConnected:r!==c.length-1,loading:u,onSaveFeedbackItem:m,onIndividualSaveComplete:v},a.id))]}):i("div",{className:iw.emptyMessage,children:i(U,{variant:"body-01",marginTop:"spacing-02",marginBottom:"spacing-03",dataAttributes:{"data-automation":"trips_gai_preview_trip_day_empty","data-automation-day-id":t},children:i(_,{id:"trips_gai_day_empty",args:{sGeo:o}})})})]})})},iC={text:"yEZLz _T",completed:"xSFoe"},iN=({text:e,keySpeed:t=25,onComplete:a})=>{var[r,l]=n([]),[o,d]=n(!1),p=s([...e].reverse());return c(()=>{var e=setInterval(()=>{if(p.current.length<=0){d(!0),a?.(),clearInterval(e);return}var t=p.current.pop();l(e=>e.concat(t||""))},t);return()=>{clearInterval(e)}},[t,a,e]),i("div",{className:L(iC.text,o&&iC.completed),children:r.join("")})},iP={poweredByAI:"GZJOX f Q2",iconBrand:"vTQRY Rb f",ctaDisclaimerWrapper:"yrPGt f MJ",saveOrViewTripCtaWrapper:"ZPXDt"},iS=({isOpen:e,close:t,children:a})=>{var r=s(null);return c(()=>{if(r.current&&"undefined"!=typeof IntersectionObserver){var i=new IntersectionObserver(([i])=>{!i.isIntersecting&&e&&t()},{rootMargin:"-160px 0px 0px 0px"});return i.observe(r.current),()=>{i.disconnect()}}return()=>{}},[t,e]),i("div",{ref:r,children:a})},iD=({onClose:e,tripId:t})=>{var{localize:a}=f(),r=eb(t),n=p(t=>{e(t),r({itemName:"CloseHotelsListShelf",customData:{reason:t}})},[e,r]);return i(eH,{items:l(()=>[{key:"have_place_to_stay",content:a.string("trips_v2_gai_places_to_stay_close_option_have_place"),onClick:()=>n("have_place_to_stay"),icon:eq},{key:"dont_like_options",content:a.string("trips_v2_gai_places_to_stay_close_option_dont_like"),onClick:()=>n("dont_like_options"),icon:eR},{key:"not_looking",content:a.string("trips_v2_gai_places_to_stay_close_option_not_looking"),onClick:()=>n("not_looking"),icon:eF}],[a,n]),above:!0,alignEdge:"right",isUpdatedOnScroll:!0,children:(e,t,r,n)=>i(iS,{close:r,isOpen:n,children:i(M,{ref:e,variant:"clear",icon:k,"aria-label":a.string("common_Close"),size:"small",onClick:t})})})},ix={gaiDescriptionIcon:"fReED",descriptionContainer:"eEhMp f",descriptionWrapper:"xhvGI",reviewSnippet:"Ctfoc"},iM=({descriptionText:e,reviewSnippet:t,isAIGenerated:r,numLinesToShow:n})=>{var{localize:o}=f(),d="MOBILE"===S()?1:2,{review:s,text:c}=t||{},p=l(()=>r?i(e$,{className:ix.gaiDescriptionIcon,src:"/img2/trips/itinerary_description_icon_gai.svg","data-automation":"trip_card_description_gai_icon"}):s?.userProfile?.avatar?.photoSizes&&s.userProfile.route?.url?i(er,{theme:"image",href:s.userProfile.route.url,target:"_blank",children:i(eJ,{size:"xs",source:s.userProfile.avatar.photoSizes,marginRight:"spacing-02"})}):null,[s?.userProfile?.avatar?.photoSizes,s?.userProfile?.route?.url,r]),u=l(()=>{var t=c&&s?.userProfile?.displayName&&s.userProfile.route?.url&&s.route?.url;if(r||!t){var l=c||e;return i("p",{className:ix.descriptionWrapper,children:i(U,{elementType:"span",display:"inline",variant:"supporting-01",color:"secondaryText",dataAttributes:{"data-automation":"trip_card_description_expanded"},children:i(eh,{ctaNewline:!0,numLinesToShow:n||d,webkitLineClamp:!0,collapsible:!0,cta:i(x,{variant:"primary-small",marginTop:"spacing-02",dataAttributes:{"data-automation":"trip_card_description_read_more"},children:o.string("common_Read_more")}),ctaCollapse:i(x,{variant:"primary-small",marginTop:"spacing-02",dataAttributes:{"data-automation":"trip_card_description_read_less"},children:o.string("common_Readless")}),children:l},eK(l))})})}return t?a(U,{elementType:"span",display:"inline",variant:"supporting-01",color:"secondaryText",dataAttributes:{"data-automation":"trip_card_description"},children:[i(er,{theme:"none",href:s.route.url,target:"_blank",children:i("span",{className:ix.reviewSnippet,children:`"${c.trim()}"`})})," - ",i(er,{theme:"standalone",href:s.userProfile.route.url,target:"_blank",children:s.userProfile.displayName})]}):null},[c,s?.userProfile?.displayName,s?.userProfile?.route?.url,s?.route?.url,r,n,d,o,e]);return a("div",{className:ix.descriptionContainer,children:[p,u]})},iB=e=>e0(K(e1(e)||new Date,1)),iA=({baseUrl:e,geoId:t,tripDate:i})=>{if(!e)return"";var a=i?.exactDate?.endDate&&i.exactDate.endDate===i.exactDate.startDate?iB(i.exactDate.endDate):i?.exactDate?.endDate;return`${e}${t?`-g${t}`:""}${i?.exactDate?.startDate&&a?`?staydates=${eQ(i.exactDate.startDate)}_${eQ(a)}`:""}`},iE=(e,t,i,a,r)=>ec({latitude:e,longitude:t},{latitude:i,longitude:a},r),iL={container:"NabfV Re Pj PX Pw PJ B1 Z BB z",cardHeader:"FyeBt Fo G",header:"weMCn G",headerMedia:"avaGt w",title:"AxtVP MH o",locationInfo:"VfMrM K e",amenities:"oatnA K",amenity:"xhvHV",amenityIcon:"qlWmS S6",description:"Hhutp"},iR=e=>e.detail?.__typename==="Hotel"?e.detail?.hotel?.providerStarRating:void 0,iO=({tripId:e,tripDate:t,hotelLocation:r,onClick:n,onIndividualSaveComplete:o})=>{var{localize:d}=f(),s=ef(),c=eb(e),{name:u,locationId:m,locationV2:v,locationDescription:h,photos:g,route:b,reviewSummary:y,reviewSnippet:I,latitude:T,longitude:w}=r,k=ep(),{rating:C,count:P}=y||{},{bestAwardForActiveYearV2:D,hierarchy:x}=v||{},M=x?.naturalParent?.geocode?.latitude,B=x?.naturalParent?.geocode?.longitude,A="MOBILE"===S(),E=e=>{n?.(),c({itemName:"HotelsListClick",customData:{itemId:r.locationId,clickedOn:e}})},{price:L,loading:R}=eZ({location:r,checkInDate:t?.exactDate?.startDate||"",checkOutDate:t?.exactDate?.endDate||"",boldPrice:!0},!r?.locationId||!t?.exactDate?.startDate||!t?.exactDate?.endDate),O=iA({baseUrl:b?.url,tripDate:t}),j=(t,i)=>{s({itemName:"SuccessfulItemSave",itemType:"ViewGAI",customData:{itemId:m,gaiTripId:e,destinationTripId:i,saveCreationMethod:"GAI",isNew:"CREATED"===t}})},z=iR(r),V=l(()=>{if(!M||!B||!T||!w)return null;var e=iE(M,B,T,w,k);return e?"MILES"===k?i(_,{id:"trips_for_you_card_hotel_distance_from_center_miles",args:{distance:e.toFixed(1)}}):i(_,{id:"trips_for_you_card_hotel_distance_from_center_km",args:{distance:e.toFixed(1)}}):null},[M,B,T,w,k]),{setSelectedItemId:F}=N(),W=p(()=>{A||F(m)},[F,m,A]),Z=p(()=>{F(null)},[F]),Y=l(()=>{if(r?.detail?.__typename==="Hotel"){var[e,t]=[...r.detail?.amenityList?.highlightedAmenities?.propertyAmenities??[],...r.detail?.amenityList?.nonHighlightedAmenities?.propertyAmenities??[]].reduce(([e,t],i)=>(i?.tagId&&i.tagId in tD?e.push(i):i?.tagId&&t.push(i),[e,t]),[[],[]]);return[...e,...t.slice(0,Math.max(0,3-e.length))].filter(e=>!!e?.amenityNameLocalized&&!!e?.tagId).map(e=>{var t=eY(eX(e));return a("div",{className:iL.amenity,children:[i("span",{className:iL.amenityIcon,children:t?i(t,{}):null}),i(U,{variant:"supporting-01",elementType:"span",children:e.amenityNameLocalized})]},String(e.tagId))})}return[]},[r]);return a("div",{"data-automation":"intermediate_hotel_card",className:iL.container,onMouseEnter:W,onMouseLeave:Z,children:[a("div",{className:iL.header,children:[g?.[0]?.photoSizes?i("div",{className:iL.headerMedia,children:i(Q,{award:D?.year?i(en,{size:"large",color:"BOTB"===D.awardType?"yellow":"green",year:D.year}):void 0,action:i(eu,{id:m??0,type:"location",onSaveComplete:o,viewTripOpensNewTab:!0,onViewTripToastVisible:j,onAutosavedToTripToastVisible:j,sourceTripId:e,creationMethod:"GENERATIVE_AI"}),children:i(er,{"data-automation":"intermediate_hotel_card_image",display:"block",theme:"image",href:O,target:"_blank",onClick:()=>E("image"),children:i(ea,{source:g[0].photoSizes,width:140,height:140,aspectRatio:"1:1"})})})}):null,a("div",{children:[a("div",{className:iL.cardHeader,children:[i(er,{href:O,onClick:()=>E("title"),target:"_blank",theme:"standalone",children:i(U,{variant:"title-04",dataAttributes:{"data-automation":"intermediate_hotel_card_title"},children:i("span",{className:iL.title,children:u})})}),C&&P&&i(er,{href:`${O}#REVIEWS`,onClick:()=>E("review-data"),target:"_blank",theme:"standalone",children:i(eE,{size:"small",rating:C,numReviews:P})})]}),a("div",{className:iL.locationInfo,children:[V&&i(eU,{content:V,icon:G,dataAttributes:{"data-automation":"intermediate_hotel_card_distance"}}),!!z&&i(eU,{content:d.string("trips_for_you_card_hotel_class",{hotelClass:z}),icon:eq}),R?i(q,{width:"100%",height:"17px"}):L&&i(U,{variant:"supporting-01",dataAttributes:{"data-automation":"intermediate_hotel_card_price"},children:L})]})]})]}),Y?.length||h?i(H,{marginTop:"spacing-03",marginBottom:"spacing-03"}):null,Y.length?i("div",{className:iL.amenities,children:Y}):null,(h||I)&&i("div",{"data-automation":"intermediate_hotel_card_description",className:iL.description,children:i(tS,{numLinesToShow:5,descriptionText:h||"",isAIGenerated:!!(I?.text&&!I?.review),reviewSnippet:I})})]})},ij={shelf:"NTMtN",carousel:"lrZNb f Q3 _t _h",arrowLeft:"Ahasf X0 Z1",arrowRight:"tRvns X0 Z1"},iz=({icon:e,label:t,onClick:a})=>i(M,{icon:e,variant:"primary-border","aria-label":t,onClick:a}),iV=({tripId:e,children:t})=>{var r=eb(e),[n,l,o,d]=e2({threshold:100}),{localize:s}=f(),c=e=>{if(l){r({itemName:"ScrollHotelsListShelf"});var t=l.children[0],i=l.children[1].offsetWidth+t.offsetLeft;l.scrollBy({left:("LEFT"===e?-1:1)*i,behavior:"smooth"})}};return a("div",{className:ij.shelf,children:[i("div",{ref:n,className:ij.carousel,children:t}),o&&i("div",{className:ij.arrowLeft,children:i(iz,{icon:e3,label:s.string("common_Previous"),onClick:()=>c("LEFT")})}),d&&i("div",{className:ij.arrowRight,children:i(iz,{icon:e4,label:s.string("common_Next"),onClick:()=>c("RIGHT")})})]})},iG=({onClose:e,placesToStay:t,tripId:r,tripDate:n})=>{var l=ey(r);return a("div",{ref:eP(()=>{l({itemName:"HotelsListShelf",customData:{hotelIds:t.flatMap(e=>e.locationId)}})}),children:[a("div",{className:"MJ f k u",children:[i(U,{variant:"title-03",marginRight:"spacing-03",children:i(_,{id:"trips_v2_gai_trip_preview_places_to_stay_heading"})}),i(tP,{onClose:e,tripId:r})]}),i(U,{variant:"body-01",color:"placeholderText",marginBottom:"spacing-04",children:i(_,{id:"trips_v2_gai_trip_preview_places_to_stay_description"})}),i(tM,{tripId:r,children:t.map(e=>i(tx,{hotelLocation:e,tripId:r,tripDate:n},e.locationId))})]})},iq=({geoId:e,tripId:t,tripDate:r})=>{var n=iA({baseUrl:"Hotels",geoId:e,tripDate:r}),l=eb(t),o=ey(t);return a("div",{ref:eP(()=>{o({itemName:"SeeMoreHotels"})}),children:[i(U,{variant:"title-03",marginBottom:"spacing-04",children:i(_,{id:"trips_v2_gai_trip_preview_places_to_stay_heading"})}),a("div",{className:"PQOmJ f Pk PY Px PK Q3 Re",children:[i("div",{className:"HiKTX f F0 u j Re",children:i(eq,{size:24})}),a("div",{children:[i(U,{variant:"body-01",marginBottom:"spacing-01",children:i(_,{id:"trips_v2_gai_places_to_stay_alert_text"})}),i(x,{href:n,onClick:()=>{l({itemName:"ClickSeeMoreHotels"})},target:"_blank",children:i(_,{id:"trips_v2_gai_places_to_stay_alert_link"})})]})]})]})},iF=({onUndo:e,tripId:t})=>{var[r,n]=o(Y),l=eb(t);return p(t=>{var o=i(e8,{onClick:()=>{e(),n(),l({itemName:"UndoHotelsShelfClose",customData:{reason:t}})},children:i(_,{id:"stat_modal_undo"})});r({node:i(Z,{cta:o,children:a(ek,{display:"flex",alignItems:"center",children:[i(e6,{size:24,marginRight:"spacing-03"}),i("span",{children:i(_,{id:"trips_v2_gai_places_to_stay_toast_message"})})]})})})},[n,r,e,l])},iH=({geoId:e,onDismiss:t,onSelectMenuOption:a,onDismissUndo:r,placesToStay:o,tripId:d,tripDate:s})=>{var[c,u]=n("carousel"),{sectionRefMapping:m}=tF(),v=m.get(iu(ip)),h=tE({onUndo:p(()=>{u("carousel"),r()},[r]),tripId:d}),g=p(e=>{a(),"dont_like_options"===e?u("see-more"):(t(),h(e))},[h,t,a]),_=l(()=>{switch(c){case"carousel":return i(tB,{onClose:g,placesToStay:o,tripId:d,tripDate:s});case"see-more":return i(tA,{geoId:e,tripId:d,tripDate:s});default:return null}},[e,g,o,c,s,d]);return i("div",{ref:v,children:_})},iW=({tripId:e,tripTitle:t,tripDescription:l,geoId:o,geoName:d,days:s,tripDate:u,loading:m,onReady:v,onSaveFeedbackItem:h,onIndividualSaveComplete:g,saveOrViewTripCta:_})=>{var[b,y]=n(!1),[I,T]=n(!1),{showPlacesToStay:w,setSavePlacesToStay:k,placesToStay:C,setShowPlacesToStay:N}=B(),{localize:P}=f();c(()=>{if(l&&b&&!I){var e=setTimeout(()=>{T(!0)},1e3);return()=>clearTimeout(e)}},[b,I,l]);var S=p(()=>{y(!0),v?.()},[v]);return i(X,{children:a("div",{children:[a("div",{className:iP.ctaDisclaimerWrapper,children:[a("div",{className:iP.poweredByAI,children:[i("div",{className:iP.iconBrand,children:i(W,{size:16})}),i(U,{variant:"supporting-02",color:"placeholderText",children:P.string("native_gai_trip_powered_by_ai")})]}),!m&&_&&i("div",{className:iP.saveOrViewTripCtaWrapper,children:_("top")})]}),t&&i(U,{variant:"title-02",marginBottom:"spacing-04",dataAttributes:{"data-automation":"trips_gai_preview_trip_title"},children:i(tN,{text:t,onComplete:S})}),(b||!m)&&i(tk,{ready:!!l||!m,placeholder:i(tc,{}),children:!!l&&i(U,{variant:"body-01",dataAttributes:{"data-automation":"trips_gai_preview_trip_description"},children:l})}),w&&!!C?.length&&a(r,{children:[i(H,{marginY:"spacing-04"}),i(tL,{tripId:e,geoId:o,tripDate:u,onDismiss:()=>N(!1),onDismissUndo:()=>{N(!0),k(!1)},onSelectMenuOption:()=>k(!1),placesToStay:C})]}),(I||!m)&&a(r,{children:[i(H,{marginY:"spacing-04"}),s.map(({id:t,title:a,description:r,formattedDescription:n,items:l},s)=>i(tC,{tripId:e,id:t,geoId:o,geoName:d,title:a,formattedDescription:n,fallbackDescription:r,items:l,expandFirstItem:0===s,loading:m,onSaveFeedbackItem:h,onIndividualSaveComplete:g},t))]})]})})};function iU(e){var[t,i]=n(!1);return p((...a)=>{t||(i(!0),e(...a))},[e,t])}var iZ={bar:"eAdfK w",fade:"TnzZF",progress:"nDHWc",message:"PXCKk f K o F",spacer:"ghkJD"},iY=({progress:e=0,message:t,"aria-label":r})=>{var[l,o]=n(0),[d,s]=n("LOADING");return 0!==l&&e>l&&o(e),c(()=>{0===l&&o(e)},[l,e]),c(()=>{if(100===l){var e=setTimeout(()=>{s("COMPLETE")},1e3),t=setTimeout(()=>{s("HIDDEN")},2e3);return()=>{clearTimeout(e),clearTimeout(t)}}},[l]),"HIDDEN"!==d?a("div",{className:L(iZ.bar,"LOADING"!==d&&iZ.fade),role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":l,"aria-label":r,children:[i("div",{className:iZ.progress,style:{width:`${l}%`}}),t&&a("div",{className:iZ.message,style:{width:`${l}%`},children:[i("span",{className:iZ.spacer}),i(U,{variant:"supporting-02",color:"accentPurpleText",children:t})]})]}):null},iX={gaiTrip:"OKHCk",content:"KUkEb",itinerary:"CamCP",map:"PWuLm",mapWrapper:"vNChN",tabBar:"bYkpq QA z",chip:"uXLJv",progressBar:"MYIBl l",closeButton:"imZtv Z1"},i$=({tripId:e,title:t,description:o,days:d,tripDate:s,centerPoint:u,geoId:m,geoName:v,loading:h,progress:b=0,scrollContainerRef:y,onSaveFeedbackItem:C,modalHeader:N,onClose:D,saveOrViewTripCta:x,onIndividualSaveComplete:E})=>{var[L,R]=n(h),O=w(),j=T(),{localize:z}=f(),V="MOBILE"===S(),{showPlacesToStay:G,setShowPlacesToStay:q,setSavePlacesToStay:F,setPlacesToStay:H}=B(),{placesToStay:W,fetching:U}=A({tripId:e});c(()=>{W?.length&&!U&&(q(!0),F(!0),H(W))},[U,W,H,F,q]);var Z=iU(p(()=>{j("TripGaiTripDetails",{date:new Date().toISOString(),timestamp:Date.now(),tripId:e,title:t,titleNarration:o,days:d.map(e=>({day:e.title,dayNarration:e.description,items:e.items.map(e=>({id:e.id,location:e.locationItem?.object?.name,GAIItemNarration:e.gaiNarration,bookableExperienceId:ir(e)}))}))})},[d,o,j,t,e])),Y=iU(p(()=>{j("TripGAITripGenerated",{date:new Date().toISOString(),timestamp:Date.now(),tripId:e})},[j,e]));c(()=>{h||Z()},[h,Z]);var X=p(()=>{Y(),R(!1)},[Y]),$=l(()=>{var e=new Map;return e.set(iu(ip),g()),d.flatMap(e=>[iu(e.id),...e.items.map(t=>im(e.id,t.id))]).reduce((e,t)=>(e.set(t,g()),e),e)},[d]),J=d[0]?$.get(iu(d[0].id)):void 0,K=l(()=>[...G?[$.get(iu(ip))]:[],...d.map(e=>$.get(iu(e.id)))].filter(Boolean),[d,G,$]),Q=(t,i)=>{var a=$.get(iu(t));a&&(O("TripDetailsDayJump",{tripId:e,dayId:t}),i(a))},ee=p(t=>{var i=d[t];i&&O("TripDetailsScroll",{tripId:e,day:i.title})},[d,O,e]),et=h?Math.min(b,L?20:100):100,ei=et<=85?z.string("trips_gai_entry_finalizing_itinerary"):void 0;return i(P,{children:a(to,{scrollContainerRef:y,sectionRefMapping:$,children:[J&&!h&&i(td,{saveOrViewTripCta:x,onActiveTabChange:ee,anchorRef:J,tabSectionRefs:K,tabBar:(e,t)=>a(r,{children:[V?N:null,i(e5,{value:t,fullBleed:!1,children:a("div",{className:iX.tabBar,children:[G&&i("div",{className:iX.chip,children:i("div",{children:i(e9,{widthVariant:"full",selected:0===t,onClick:()=>Q(ip,e),"aria-label":z.string("trips_v2_gai_trip_preview_places_to_stay_heading"),dataAttributes:{"data-automation":"trips_gai_preview_trip_places_to_stay_tab"},children:i(_,{id:"trips_v2_gai_trip_preview_places_to_stay_heading"})})})},ip),d.map((a,r)=>i("div",{className:iX.chip,children:i(e9,{widthVariant:"full",selected:G?r+1===t:r===t,onClick:()=>Q(a.id,e),"aria-label":a.title?.toString(),dataAttributes:{"data-automation":"trips_gai_preview_trip_day_tab","data-automation-day-id":a.id},children:a.title})},a.id))]})})]})}),a("div",{className:iX.gaiTrip,children:[i("div",{className:iX.progressBar,children:i(tO,{progress:et,message:ei})}),i(I,{children:a("div",{className:iX.content,children:[i("div",{className:iX.itinerary,children:i(tR,{tripId:e,tripTitle:t,geoId:m,geoName:v,tripDescription:o,days:d,tripDate:s,loading:h,onReady:X,onSaveFeedbackItem:C,onIndividualSaveComplete:E,saveOrViewTripCta:x})}),a("div",{className:iX.map,children:[V?i("div",{className:iX.closeButton,children:i(M,{onClick:D,icon:k,size:"small","aria-label":z.string("common_Close"),dataAttributes:{"data-automation":"trips_gai_modal_close_button_map"}})}):null,i("div",{className:iX.mapWrapper,children:i(tT,{tripId:e,days:d,centerPoint:u,geoId:m,loading:h,hideMarkers:L})})]})]})})]})]})})},iJ=({tripId:e,onSaveFeedbackItem:t,saveOrViewTripCta:a,onIndividualSaveComplete:r})=>{var{trip:n,fetching:l}=tf(e,null,"COMPLETE");if(!n)return null;var{title:o,description:d,days:s,centerPoint:c,geoId:p,geoName:u,progress:m,tripDate:v}=n;return i(i$,{tripId:e,title:o,description:d,days:s,tripDate:v,centerPoint:c,geoId:p,geoName:u,loading:l,onSaveFeedbackItem:t,progress:m,saveOrViewTripCta:a,onIndividualSaveComplete:r})};function iK({trip:e,saveOrViewTripCta:t,...a}){return e?i("div",{className:"vnYqC f e Q2",children:i(i$,{title:e.title,description:e.description,days:e.days,tripDate:e.tripDate,centerPoint:e.centerPoint,geoId:e.geoId,geoName:e.geoName,progress:e.progress,saveOrViewTripCta:t,...a})}):null}function iQ({tripId:e,tripTitle:t,placesToStay:r,onSave:n,onItemClick:l,onCreateTripInputChange:o,variant:d="light",position:s}){var c=w(),p=T();return i(te,{saveObject:{id:e,type:"gaiTrip"},additionalItemReferences:r?.reduce((e,t)=>(t.locationId&&e.push({id:t.locationId.toString(),type:"location"}),e),[]),initialTripTitle:t,active:!1,object:null,onComplete:(e,t)=>n(t),onItemClick:l,onCreateTripInputChange:o,onViewTripToastVisible:(t,i)=>{p("SuccessfulItinerarySave",{gaiTripId:e,destinationTripId:i,saveCreationMethod:"GAI",isNew:"CREATED"===t})},showPlacesToStay:!!r?.length,skipCreateTripTracking:!0,children:t=>i(D,{onClick:()=>{c("TripDetailsSaveItinerary",{tripId:e,position:s}),t()},variant:"light"===d?"gai":"gai-dark",dataAttributes:{"data-automation":"trips_gai_preview_trip_save_itinerary_button"},children:a("div",{className:"f u j",children:[i(e7,{marginRight:"spacing-01"}),i(_,{id:"trips_gai_modal_save_itinerary_cta"})]})})})}var i0={__key:0x98d4684e840f,id:"98d4684e840fa57a",loc:{},definitions:[]},i1=e=>"COMPLETE"===e,i2=e=>"ERROR"===e||"UNKNOWN"===e,i3=(e,t)=>i1(e)?"COMPLETE":i2(e)?"ERROR":t?"LOADING":"ERROR",i4=e=>{var[{fetching:t,data:i}]=tt({query:i0,variables:{request:{tripId:e||0}},isResultComplete:({data:e})=>{var t=e?.Trips_getGeneratedTripStatus?.status??null;return i1(t)||i2(t)},pollIntervals:tz,pause:!e}),a=i?.Trips_getGeneratedTripStatus?.status??null,r=i?.Trips_getGeneratedTripStatus?.lastUpdated??null,n=i3(a,t);return l(()=>({status:n,lastUpdated:r}),[n,r])},i6=({data:e})=>i("pre",{children:JSON.stringify(e,null,2)}),i8=({tripId:e})=>{var{path:t}=ta(),[{data:r}]=eV({query:ia,variables:{tripIds:[e??0],currency:y()},requestPolicy:"cache-only",pause:!e}),n=r?.Trips_getTrips?.[0];if(!n)return i(U,{variant:"body-01",children:"Loading trip details..."});var{id:l,title:o,tripLocations:d,generatedTripRequest:s}=n||{};return a("div",{children:[i(U,{variant:"title-04",marginBottom:"spacing-03",children:o}),i(U,{variant:"title-05",marginBottom:"spacing-01",children:"Trip ID"}),i(U,{variant:"body-01",children:i(er,{theme:"inline",href:`${t}#/TripBuilder/${l}`,children:l})}),i(H,{marginY:"spacing-03"}),i(U,{variant:"title-05",marginBottom:"spacing-01",children:"Requested Params"}),i(i6,{data:s}),i(H,{marginY:"spacing-03"}),i(U,{variant:"title-05",marginBottom:"spacing-01",children:"Trip Locations"}),i(i6,{data:d})]})},i9=({tripId:e})=>(ti("GAI Trip",l(()=>i(i8,{tripId:e}),[e])),null);return e({GaiTripPreview:iK,SaveToTripButton:iQ}),[()=>{tr=d(null),tn=tV,tl=d(null),to=tq,td=u(tZ),ts=tX,tc=tJ,tp=tK,tu=tQ,tv=(tm=[{value:"dislike_recommendation",label:i(_,{id:"trips_gai_feedback_bad_recommendation"})},{value:"wrong_description",label:i(_,{id:"trips_gai_feedback_wrong_description"})},{value:"unrelated_link",label:i(_,{id:"trips_gai_feedback_unrelated_page"})}]).map(e=>e.value),th=t5,tg=it,t_=ii,tf=ic,tb=m(function({step:e,title:t,content:r,isOpen:n,onExpandCollapseClick:l,onMouseEnter:o,onMouseLeave:d,isConnected:s=!0,dataAttributes:c},p){var u=i("div",{className:iv.marker,children:i(U,{variant:"button-03",children:e})});return a("div",{className:iv.container,ref:p,onMouseEnter:o,onMouseLeave:d,children:[a("div",{className:iv.sidebar,children:[u,i("div",{className:s?iv.bar:void 0})]}),i("div",{className:iv.card,...c?.card,children:i($,{question:i(U,{variant:"title-04",elementType:"div",dataAttributes:{"data-automation":"trips_gai_preview_trip_day_item_title"},children:a("div",{className:iv.collapsibleItem,children:[i("span",{className:iv.titleMarker,children:u}),t]})}),answer:r,answerType:"custom",onExpandCollapseClick:l,isExpanded:n})})]})}),ty=ih,tI=ig,tT=ib,tw=iy,tk=iT,tC=ik,tN=iN,tP=iD,tS=iM,tD={[eW.FreeBreakfast]:i(_,{id:"hotel_amenity_free_breakfast"})},tx=iO,tM=iV,tB=iG,tA=iq,tE=iF,tL=iH,tR=iW,tO=iY,tj=iJ,tz=[...Array(15).fill(2e3),...Array(10).fill(3e3),...Array(12).fill(5e3),...Array(42).fill(1e4)],e({GaiTripDebugger:i9,GaiTripPreview:iK,IntermediateScreen:tj,SaveToTripButton:iQ,getBookableExperienceId:ir,useGetGeneratedTrip:tf,useGetGeneratedTripStatus:i4})},[e=>(i=e.jsx,a=e.jsxs,r=e.Fragment),e=>(n=e.useState,l=e.useMemo,o=e.useContext,d=e.createContext,s=e.useRef,c=e.useEffect,p=e.useCallback,u=e.memo,m=e.forwardRef,v=e.Suspense,h=e.Fragment,g=e.createRef),e=>(_=e.default,f=e.useLocalize,b=e.useIntlFormatter,y=e.useCurrency),e=>I=e.default,e=>(T=e.usePreviewImpressionLogger,w=e.usePreviewInteractionLogger),e=>k=e.default,e=>(C=e.default,N=e.useTripsMapContext,P=e.TripsMapProvider),e=>S=e.useViewportCategory,e=>(D=e.default,x=e.BorderlessButton,M=e.CircularButton),e=>(B=e.usePlacesToStayContext,A=e.useFetchPlacesToStay),e=>E=e.useKeyboardNavigationMode,e=>L=e.default,e=>R=e.default,e=>O=e.default,e=>j=e.ErrorBoundary,e=>z=e.ModalBase,e=>V=e.default,e=>G=e.default,e=>q=e.Skeleton,e=>F=e.default,e=>H=e.default,e=>W=e.default,e=>U=e.default,e=>(Z=e.ToastItem,Y=e.Toast,X=e.ToastProvider),e=>$=e.ControlledCollapsibleListItem,e=>(J=e.isLocationItemObject,K=e.addDays),e=>(Q=e.CardMedia,ee=e.FlexCard,et=e.CardContent,ei=e.CardText),e=>ea=e.default,e=>er=e.default,e=>en=e.default,e=>el=e.default,e=>(eo=e.TripLocationIconContent,ed=e.getLocationReviewData,es=e.CardHeaderElement,ec=e.haversineDistance,ep=e.useDistanceUnit),e=>eu=e.default,e=>(em=e.getSATDModalSaveObject,ev=e.getLocationPhotos),e=>eh=e.ReadMore,e=>eg=e.default,e=>e_=e.default,e=>(ef=e.useImpressionLogger,eb=e.useViewGaiInteractionLogger,ey=e.useViewGaiImpressionLogger),e=>eI=e.default,e=>eT=e.default,e=>ew=e.default,e=>ek=e.Box,e=>(eC=e.ToastProvider,eN=e.useToast),e=>eP=e.useOnVisible,e=>eS=e.default,e=>eD=e.default,e=>ex=e.useVDOMPortal,e=>eM=e.ModalContainer,e=>eB=e.TextInput,e=>eA=e.Checkbox,e=>eE=e.BubbleRatingWithReviewCount,e=>eL=e.default,e=>eR=e.default,e=>(eO=e.default,ej=e.getMarginProps,ez=e.margin),e=>eV=e.useQuery,e=>eG=e.getTripItemIcon,e=>eq=e.default,e=>eF=e.default,e=>eH=e.PopoverMenu,e=>eW=e.amenityTags,e=>eU=e.IconDetail,e=>eZ=e.useHotelPrice,e=>(eY=e.getAmenityIcon,eX=e.getAmenityIconName),e=>e$=e.CdnImage,e=>eJ=e.Avatar,e=>eK=e.stringHash,e=>eQ=e.formatDateParam,e=>(e0=e.dateToISOString,e1=e.isoStringToDate),e=>e2=e.useCanScroll,e=>e3=e.default,e=>e4=e.default,e=>e6=e.default,e=>e8=e.default,e=>e9=e.ChipButton,e=>e5=e.TabBar,e=>e7=e.default,e=>te=e.TripFlowSelector,e=>tt=e.usePollingQuery,e=>ti=e.useDebugPane,e=>ta=e.useRoute]]},["21h32l","o4yt4q","7thqz4","94v69w","ibebqy","qkjm8h","amwhbz","ys6v1o","jppfwt","aj74qn","2r4qug","fkji80","d6vj30","dsbyen","83pm0d","uzmmz7","7nq86i","bp96i9","qndsds","ndszpi","covaqn","qk22ay","essqvy","tr3542","ahn2ts","r6ayw2","6m9vgr","34bu7w","lr6tb6","p9ucm8","2rns1i","9l2zsy","dpzonz","xznza0","wgun1f","i0z8n1","4ilds0","sa2a6q","s1ymgp","7a7jm3","ec91du","lyyh8d","nntg4s","3btuy0","wehxiu","n4zdla","4euaes","i3sz5h","u3aiot","frf6ac","bkeq24","u47wjb","w43m8k","gw8uw6","mqwhqn","j2ln1o","c5q3iu","43er8k","s2gl90","ztz79u","70j2tf","vtj79r","he3p3w","s6q22n","ljqkwp","eww825","iyqcwg","o5y7tg","c4482w","a6i9w3","6qmqhw","d3i8k1","6g4avl","b1cljk","227h6c","l75rcq","9rb8bq","fbuhsy","uvk21c","fgwvq1"]]);
