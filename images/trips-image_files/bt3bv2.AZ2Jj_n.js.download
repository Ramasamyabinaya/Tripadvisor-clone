(this.$WP=this.$WP||[]).push(["bt3bv2",(e,t)=>{var r,a,i,n,s,l,o,u,c,m,T,E,_,d,v,g,I,p,y,w,A,h,H,b,R,f,S,P,x,D,C,L,k,M,V,N,B,z,K,F,X,O,j,q,W,Z,G,U,Y,Q,$,J,ee,et,er,ea,ei="test",en="EXIT",es="sdk_page_view_trigger",el="brazeInitialized",eo="brazeInterstitialsData",eu="visible",ec="USER",em=["AttractionProductReview","Hotel_Review","HotelsFusion"],eT=["ShowTopic","Tourism"],eE="extend_braze_sdk_on_dt_and_mw_1699021043",e_=["AttractionProductReview","Hotel_Review","Hotels","HotelsFusion"],ed=["Attraction_Review","AttractionProductHighlight","AttractionProductsFusion","AttractionsFusion","AttractionsHome","AttractionsNear","FindRestaurants","ForumHome","Home","Hotel_Feature","HotelHighlight","HotelsHome","HotelsList","HotelsListFusion","HotelsNear","ListForums","Restaurant_Review","Restaurants","RestaurantsHome","RestaurantsNear","Search","SearchForums","ShowForum","ShowUserReviews","SmartDeals"],ev="ExperiencesExitIntentInterstitial",eg="EXP_EXIT",eI="experiences_exit_interstitial_v2_1697228327",ep=["Hotel_Review"],ey="HotelsExitIntentInterstitial",ew="HOTELS_EXIT",eA="hotels_exit_interstitial__h_v2_1700590819",eh="HOTEL_REVIEW_EXIT",eH="HotelReviewExitIntentInterstitial",eb="PAGE_VIEW_TEMPLATE",eR=["HotelsFusion"],ef="hotels_exit_interstitial__h_v3_1701457107",eS=(e,t,r)=>{var a=e.get(t),i=new Date().getTime();return a&&a?.find(e=>e.key===r&&(!e.ttl||e.ttl>=i))||null},eP=(e,t,r)=>{var a=ex(),i=eS(a,e,t)?.value;return i&&"object"==typeof i?i[r]:null},ex=()=>new Map(E.get(eo)),eD=(e,t,r)=>{var a=e.get(t),i=new Date().getTime();return a=a?.filter(e=>e.key!==r.key&&(!e.ttl||e.ttl>=i))||[],r.ttl&&(r.ttl+=i),a.push(r),e.set(t,a),e},eC=(e,t,r,a)=>{if(null!=e){var i=ex();eD(i,e,{key:t,value:r,ttl:a}),E.set(eo,Array.from(i.entries()))}},eL=(e,t,r,a)=>{if(null!=e){var i=eP(e,a,t);eC(e,a,{[t]:null==i?1:i+1},r)}},ek=e=>{var t=F.getObjectValueFromStorage(e,eu,ec);return null==t?0:t},eM=e=>ek(e)+1,eV=e=>"Hotel_Review"===e?"hotels_exit_interstitial__hr_us_v2_1701184978":"",eN=(e=!1)=>{var{page:t}=m(),{userAgentCategory:r}=v(),a=ep.includes(t),i=eV(t),n=y({experimentKeys:[i],skipImpression:e,page:t},!a||!i||"DESKTOP"!==r);return n?n[i]:""},eB=()=>{var{page:e}=m(),{userAgentCategory:t}=v(),r=ed.includes(e),a=e_.includes(e)&&"DESKTOP"!==t,i=y({experimentKeys:[eE],page:e},!r&&!a);return i?i[eE]:""},ez=()=>{var e=X(!0)===ei,t="test"===O();return e||t},eK=(e,t)=>{var[r,a]=n(!1);return s(()=>{var r;return t||(r=setTimeout(()=>a(!0),e)),()=>clearTimeout(r)},[e,t]),r},eF=()=>{var{page:e}=m(),t=I(p.TARGETING),{userAgentCategory:r}=v(),a=eT.includes(e)||"DESKTOP"===r&&em.includes(e),i=j();return q(0,!1)&&t&&(a||i)},eX={error:"/HD6ArEBAtTwBI7ZVjta90qp4unZxfbHurUTBGj19rQQ0+FVYV8WhM5fZH0wzrq+",ok:"/HD6ArEBAtTwBI7ZVjta9/W82wQIR3jyvbLaRjmIOqY="},eO=(e,t)=>{G.set(e,t)},ej=e=>G.get(e),eq=`\u0022`,eW=()=>{var e=W(),{browser:r,os:a}=v(),i=d(),n=g(),s=_(),{params:o}=m(),u="detailId"in o?o.detailId:0,c="geoId"in o?o.geoId:0,T=Z.useConstantIncrementCallback();return l(async({event:l,eventProperties:o})=>{if(E.get(el)&&e){var{logCustomEvent:m}=await t("tnit44");try{var _,d=ej(l),v=!!d,g=v?(_={},Object.entries(d).forEach(([e,t])=>{_[e]="string"==typeof t?t.replace(eq,'\\"'):t}),_):null;m(l,{...o,page:s,detailId:u,geoId:c,deviceType:i,locale:n,customEventData:g,isCustomEventDataPresent:v}),T(eX.ok)}catch(e){console.error(`[Braze] Problem occurred on: ${r.family} - ${r.majorVersion} | ${a.family} - ${a.majorVersion} | `,e),T(eX.error)}}},[e,s,u,c,i,r,a,n,T])},eZ=()=>{var{params:e}=m(),t=_(),r=!!f(),a=R();return{trackImpression:l(({itemName:i,customData:n})=>{a({itemName:i,page:t,geoId:"geoId"in e&&e.geoId||null,locationId:"detailId"in e&&e.detailId||null,customData:JSON.stringify({...n,signedIn:r,isEligibility:!0})})},[a,e,t,r])}},eG=e=>{switch(e){case"variant1":return N;case"variant2":return 0;case"control":return V;default:return M}},eU=e=>{var{page:t}=m(),{userAgentCategory:r}=v(),{experimentBuckets:a,fetching:i}=w({experimentKeys:[eI]},e||"DESKTOP"!==r||"AttractionProductReview"!==t);return{delayTime:eG(a?.[eI]||""),fetching:i}},eY=e=>"test"===e?z:B,eQ=e=>{var{page:t}=m(),{userAgentCategory:r}=v(),{experimentBuckets:a,fetching:i}=w({experimentKeys:[eA]},e||"DESKTOP"!==r||"HotelsFusion"!==t);return{delayTime:eY(a?.[eA]||""),fetching:i}},e$={interstitialMaxDisplay:-1,template:"",trackItemName:"",exitDelayTime:-1,fetching:!1},eJ=e=>{var{page:t}=m(),{delayTime:r,fetching:a}=Q(e),{delayTime:i,fetching:n}=$(e);switch(t){case"AttractionProductReview":return{fetching:a,interstitialMaxDisplay:3,template:eg,trackItemName:ev,exitDelayTime:r};case"HotelsFusion":return{fetching:n,interstitialMaxDisplay:3,template:ew,trackItemName:ey,exitDelayTime:i};case"Hotel_Review":return{fetching:!1,interstitialMaxDisplay:3,template:eh,trackItemName:eH,exitDelayTime:M};case"ShowTopic":return{fetching:!1,interstitialMaxDisplay:1,template:eb,trackItemName:"ShowTopicPageView",exitDelayTime:0};case"Tourism":return{fetching:!1,interstitialMaxDisplay:1,template:eb,trackItemName:"TourismPageView",exitDelayTime:0};default:return e$}},e1=({page:e,logBrazeTriggersCustomEvent:t,trackBrazeTriggerImpression:r})=>{var a=o(Date.now()),[i,c]=n(!1),[m,E]=n(!1),_=X(!i),{interstitialMaxDisplay:d,template:v,trackItemName:g,exitDelayTime:I,fetching:p}=J(!i),y=u(()=>K.get(en)?.includes(e)??!1,[e]),w=l(()=>{t({template:v,event:en,abTestValue:_})},[v,_,t]),A=o(w),h=l(()=>{(y||_===ei)&&r({template:v,interstitialMaxDisplay:d,trackItemName:g,eventType:en})},[y,_,v,d,g,r]),H=o(h),b=l(e=>{e.clientY<=0&&(c(!0),E(!0))},[c]);return s(()=>{A.current!==w&&(A.current=w),H.current!==h&&(H.current=h)},[w,h]),s(()=>{var e=Date.now()>a.current+I;p||(i&&e&&m&&(_||y)&&(A.current(),H.current()),E(!1))},[I,p,i,m,_,y]),T("mouseout",b),null},e0=()=>{var{page:e}=m(),{userAgentCategory:t}=v(),r=eR.includes(e),a=y({experimentKeys:[ef],page:e},!r||"DESKTOP"!==t);return null===a?null:a?a[ef]:""},e5=({logBrazeTriggersCustomEvent:e,trackBrazeTriggerImpression:t})=>{var[r,a]=n(!1),i=W(),{interstitialMaxDisplay:u,template:c,trackItemName:m}=J(!0),T=l(()=>{e({template:c,event:es,abTestValue:"test"})},[c,e]),_=o(T),d=l(()=>{t({template:c,interstitialMaxDisplay:u,trackItemName:m,eventType:es})},[c,u,m,t]),v=o(d);s(()=>{_.current!==T&&(_.current=T),v.current!==d&&(v.current=d)},[T,d]);var g=o(0);return s(()=>{var e;return!r&&i&&(e=setInterval(()=>{g.current>10&&clearInterval(e),E.get(el)&&(_.current(),v.current(),a(!0),clearInterval(e))},500)),()=>{clearInterval(e)}},[r,i]),null},e2=({dismiss:e=()=>{}})=>{var{page:t}=m(),n=K.get(en)?.includes(t)??!1,s=K.get(es)?.includes(t)??!1,o=U(),u=l(({template:e,event:t,abTestValue:r})=>{o({event:t,eventProperties:{abTestValue:r,displayCount:eM(e)}})},[o]),{trackImpression:c}=Y(),E=l(({template:e,interstitialMaxDisplay:t,trackItemName:r,eventType:a})=>{var i=eM(e);i<=t&&c({itemName:r,customData:{impressionCount:i,sessionCount:i,eventType:a}})},[c]);return T("beforeunload",e),a(i,{children:[n&&r(ee,{page:t,logBrazeTriggersCustomEvent:u,trackBrazeTriggerImpression:E}),s&&r(er,{logBrazeTriggersCustomEvent:u,trackBrazeTriggerImpression:E})]})},e3=()=>{var e=et();return null===e?null:"test"===e?r(e2,{}):r(e7,{})},e7=()=>{var e=e=>r(e2,{dismiss:e}),t="interstitials-braze";return c({factory:({dismiss:t})=>e(t),eventTypes:[t],key:t,tier:700}),null},e4={__key:0xb28d0534b3ca,id:"b28d0534b3caa770",loc:{},definitions:[]},e6=()=>{var[e,a]=n(null),i=D(),l=u(()=>!!(i.startsWith("hare")||i.includes("qa.tripadvisor-preview.com")),[i]),[{data:c}]=C({query:e4}),m=o(),T=f();return s(()=>{var e;return(async()=>{var{initialize:r,automaticallyShowInAppMessages:i,openSession:n,destroy:s,getUser:o}=await t("tnit44"),u=r(l?"33cabfd1-22ad-4bb9-b839-923528e22192":"6e55efa5-e689-47c3-a55b-e6d7515a6c5d",{baseUrl:"sdk.iad-05.braze.com",sessionTimeoutInSeconds:60,minimumIntervalBetweenTriggerActionsInSeconds:1,enableLogging:l,allowUserSuppliedJavascript:!0,manageServiceWorkerExternally:!0,noCookies:!0,inAppMessageZIndex:10104,doNotLoadFontAwesome:!0});u?(i(),n(),e=s,m.current=o(),E.set(el,!0,L)):E.set(el,!1,L),a(u)})(),()=>{e&&e()}},[l]),s(()=>{if(e&&m?.current){var t=c?.data?.hashedPersistentCookieSHA256;t&&m.current.addAlias(t,"CTA_SHA256")}},[c,m,e]),s(()=>{(async()=>{var{changeUser:r}=await t("tnit44");e&&T&&r(T)})()},[T,e]),r(S,{component:P.braze,status:e?x.ok:x.missing,enabled:null!==e})},e9=()=>W()?r(b,{children:r(e6,{})}):null;return[()=>{k=12*(30*(L=864e5)),M=15e3,V=1e4,N=5e3,B=1e4,z=5e3,K=new Map([["EXIT",["AttractionProductReview","HotelsFusion","Hotel_Review"]],["sdk_page_view_trigger",["ShowTopic","Tourism"]]]),F={getObjectValueFromStorage:eP,getBrazeStorageData:ex,saveValueToLocalStorage:eC,saveDisplayCountToBrazeStorage:eL},X=eN,O=eB,j=ez,q=eK,W=eF,Z=new A({metricName:"/HD6ArEBAtTwBI7ZVjta93C0lsh0r5m7+1h2uMR+Ctj6S7rKi5+tmJVNyp6fjPiaq5rr6c5rsp+XGnGmyrZ6y64ZVL67MHPVqEacrZP0wZY=",version:0,additionalLabels:["/HD6ArEBAtTwBI7ZVjta98Sr44QR3Z1Lmq5fKuJGI7cdKriEzyXX7YlewxVwwfzY"],labelHooks:[h,H]}),G=new Map,U=eW,Y=eZ,Q=eU,$=eQ,J=eJ,ee=e1,et=e0,er=e5,ea=e3,e({BRAZE_EXIT_EVENT_KEY:en,BRAZE_EXIT_EVENT_TEST_BUCKET:ei,Braze:e9,EXP_EXIT_TEMPLATE:eg,EXP_EXIT_TRACK_ITEM_NAME:ev,HOTELS_EXIT_TEMPLATE:ew,HOTELS_EXIT_TRACK_ITEM_NAME:ey,HOTEL_REVIEW_EXIT_TEMPLATE:eh,HOTEL_REVIEW_EXIT_TRACK_ITEM_NAME:eH,LOCAL_STORAGE_TTL_01_YEAR:k,PAGE_VIEW_TEMPLATE:eb,PER_USER_DISPLAY:ec,TRIP_PLANNING_TRACK_ITEM_NAME:"Trip Planning Interstitial",VISIBLE:eu,brazeStorage:F,default:ea,getInterstitialsCustomEventData:ej,getStoredDisplayCount:ek,setInterstitialsCustomEventData:eO,useBrazeExitIntentTest:X,useBrazeLogCustomEventCallback:U})},[e=>(r=e.jsx,a=e.jsxs,i=e.Fragment),e=>(n=e.useState,s=e.useEffect,l=e.useCallback,o=e.useRef,u=e.useMemo),e=>c=e.usePopupHierarchyRender,e=>m=e.useRoute,e=>T=e.useWindow,e=>E=e.default,e=>_=e.default,e=>d=e.useViewportCategory,e=>v=e.useUserAgent,e=>g=e.useLocale,e=>(I=e.useConsent,p=e.CategoriesEnum),e=>(y=e.useAbTestWithSegments,w=e.useAbTestWithQueryStatus),e=>(A=e.Counter,h=e.useSourceLabel,H=e.useWebApplicationLabel,b=e.ErrorBoundary),e=>R=e.default,e=>f=e.useUserId,e=>(S=e.StatusCounter,P=e.Component,x=e.Status),e=>D=e.useDomainName,e=>C=e.useQuery]]},["21h32l","o4yt4q","xo1is3","fgwvq1","ltllz9","9b9b10","eqoaya","ys6v1o","nnprhg","7thqz4","973cci","gugp1d","83pm0d","xg719z","52far5","6nmgrj","qlcuu5","mqwhqn"]]);
